<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editable Resume</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="./js/workReference.js" defer></script>
    <script src="./js/education.js" defer></script>
    <script src="./js/workExperience.js" defer></script>
    <script src="./js/skills.js" defer></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">

        <h1 class="text-2xl font-semibold mb-4"> <u>PreciseCV Maker</u></h1>
        
        <!-- Personal Details -->
        <div class="mb-10">
            <h2 class="text-2xl font-semibold mb-4"><u>Personal Details</u></h2>
            <div class="grid grid-cols-4 gap-4 border border-gray-300 p-4">
                <div>
                    <p class="font-semibold">Name:</p>
                    <input type="text" id="name" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow" placeholder="John Doe">
                </div>
                <div>
                    <p class="font-semibold">Email:</p>
                    <input type="email" id="email" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow" placeholder="john.doe@example.com">
                </div>
                <div>
                    <p class="font-semibold">Address:</p>
                    <input type="text" id="address" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow" placeholder="31 Smith Street, New York, Harare">
                </div>
                <div>
                    <p class="font-semibold">Phone:</p>
                    <input type="tel" id="phone" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow" placeholder="(263) 775 634 192">
                </div>
                <div>
                    <p class="font-semibold">Date of Birth:</p>
                    <input type="text" id="dateOfBirth" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow" placeholder="09/07/2000">
                </div>
                <div>
                    <p class="font-semibold">Gender:</p>
                    <select id="gender" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>
                <div>
                    <p class="font-semibold">Marital Status:</p>
                    <select id="maritalStatus" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow">
                        <option value="Single">Single</option>
                        <option value="Married">Married</option>
                        <option value="Divorced">Divorced</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Education -->
        <div class="mb-10" id="educationSection">
            <h2 class="text-2xl font-semibold mb-4"><u>Educational Background</u></h2>
            <div id="educationContainer">
                <div class="education border border-gray-300 p-4 mt-2 mb-2">
                    <div class="grid grid-cols-4 gap-4">
                        <div>
                            <p class="font-semibold mt-2">School Name:</p>
                            <input type="text" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow school" placeholder="School Name">
                        </div>
                        <div>
                            <p class="font-semibold mt-2">Level:</p>
                            <input type="text" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow level" placeholder="Level">
                        </div>
                        <div>
                            <p class="font-semibold mt-2">Duration:</p>
                            <input type="text" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow duration" placeholder="January 2020 - present">
                        </div>
                    </div>
                    <div class="grid gap-4 mt-4">
                        <div>
                            <p class="font-semibold mt-2"><u>Grades:</u></p>
                            <small class="mb-3"><em>Click the add Grade button to add</em></small>
                            <div class="grid grid-cols-1 gap-4 mt-4 grade-score-container">
                                <!-- Grades will be added here -->
                            </div>
                            <button class="addGrade mt-4 bg-blue-500 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded">Add Grade</button>
                        </div>
                    </div>
                </div>
            </div>
            <button id="addEducation" class="mt-4 mb-6 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Add Education</button>
        </div>

        <!-- Work Experience -->
        <div class="mb-10" id="workExperienceSection">
            <h2 class="text-2xl font-semibold mb-4"><u>Work Experience</u></h2>
            <div id="workExperienceContainer">
                <div class="work-experience border border-gray-300 p-4 mt-2 mb-2">
                    <div class="grid grid-cols-4 gap-4">
                        <div>
                            <p class="font-semibold mt-2">Position:</p>
                            <input type="text" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow position" placeholder="Position">
                        </div>
                        <div>
                            <p class="font-semibold mt-2">Company:</p>
                            <input type="text" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow company" placeholder="Company">
                        </div>
                        <div>
                            <p class="font-semibold mt-2">Duration:</p>
                            <input type="text" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow duration" placeholder="January 2020 - present">
                        </div>
                    </div>
                    <p class="font-semibold mt-2">Responsibility:</p>
                    <textarea class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow responsibility mt-2" rows="4" cols="50" placeholder="Responsibility"></textarea>
                </div>
            </div>
            <button id="addExperience" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Add Experience</button>
        </div>

        <!-- Work Reference -->
        <div class="mb-10" id="workReferenceSection">
            <h2 class="text-2xl font-semibold mb-4"><u>Work Reference</u></h2>
            <div id="workReferenceContainer">
                <div class="work-reference border border-gray-300 p-4 mt-2 mb-2">
                    <div class="grid grid-cols-4 gap-4">
                        <div>
                            <label for="position" class="block font-semibold">Position:</label>
                            <input type="text" id="position" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow position" placeholder="Position">
                        </div>
                        <div>
                            <label for="company" class="block font-semibold">Company:</label>
                            <input type="text" id="company" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow company" placeholder="Company">
                        </div>
                        <div>
                            <label for="duration" class="block font-semibold">Duration:</label>
                            <input type="text" id="duration" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow duration" placeholder="January 2020 - present">
                        </div>
                        <div>
                            <label for="title" class="block font-semibold">Title:</label>
                            <select id="title" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow">
                                <option value="Mr.">Mr</option>
                                <option value="Mrs.">Mrs</option>
                                <option value="Miss">Miss</option>
                                <option value="Dr">Dr</option>
                                <option value="Prof">Prof</option>
                            </select>
                        </div>
                        <div>
                            <label for="contact-name" class="block font-semibold">Contact Name:</label>
                            <input type="text" id="contact-name" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow contact-name" placeholder="Contact Name">
                        </div>
                        <div>
                            <label for="contact-surname" class="block font-semibold">Contact Surname:</label>
                            <input type="text" id="contact-surname" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow contact-surname" placeholder="Contact Surname">
                        </div>
                        <div>
                            <label for="contact-email" class="block font-semibold">Contact Email:</label>
                            <input type="email" id="contact-email" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow contact-email" placeholder="Contact Email">
                        </div>
                        <div>
                            <label for="contact-phone" class="block font-semibold">Contact Phone:</label>
                            <input type="tel" id="contact-phone" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow contact-phone" placeholder="Contact Phone">
                        </div>
                        <div>
                            <label for="contact-position" class="block font-semibold">Contact Position:</label>
                            <input type="text" id="contact-position" class="block w-full appearance-none bg-white border border-gray-300 hover:border-gray-400 px-4 py-2 rounded shadow contact-position" placeholder="Contact Position">
                        </div>
                    </div>
                </div>
            </div>
            <button id="addPosition" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Add Position</button>
        </div>

        <!-- Skills -->
        <div class="mb-10">
            <h2 class="text-2xl font-semibold"><u>Skills</u></h2>
            <small class="mb-3"><em>Click the add Skill button to add</em></small>
            <div id="skillsContainer" class="border border-gray-300 p-4 mt-2 mb-2">
                <div class="grid grid-cols-4 gap-4" id="skillInputs">
                    <!-- Skills will be added here -->
                </div>
            </div>
            <button id="addSkill" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Add Skill</button>
        </div>
        <button id="save" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">GENERATE CV</button>
    </div>
    <script>

        function clearFormFields() {
            document.querySelectorAll('input, select, textarea').forEach(field => {
                if (field.type === 'select-one') {
                    field.selectedIndex = 0; // Reset select fields to the first option
                } else {
                    field.value = ''; // Clear input and textarea fields
                }
            });
        }


        flatpickr("#dateOfBirth", {
            dateFormat: "Y-m-d", // Date format
            altInput: true, // Show a readable date input
            altFormat: "F j, Y", 
            maxDate: new Date().getFullYear() - 18 + "-01-01" // Set minDate to 18 years ago// Readable date format
        });

        function collectFormData() {
            const formData = {
                personalDetails: {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    address: document.getElementById('address').value,
                    phone: document.getElementById('phone').value,
                    dateOfBirth: document.getElementById('dateOfBirth').value,
                    gender: document.getElementById('gender').value,
                    maritalStatus: document.getElementById('maritalStatus').value
                },
                education: [],
                workExperience: [],
                workReference: [],
                skills: []
            };

            // Collect education data
            const educationItems = document.querySelectorAll('.education');
            educationItems.forEach((item) => {
                formData.education.push({
                    school: item.querySelector('.school').value,
                    level: item.querySelector('.level').value,
                    duration: item.querySelector('.duration').value
                });
            });

            // Collect work experience data
            const experienceItems = document.querySelectorAll('.work-experience');
            experienceItems.forEach((item) => {
                formData.workExperience.push({
                    position: item.querySelector('.position').value,
                    company: item.querySelector('.company').value,
                    duration: item.querySelector('.duration').value,
                    responsibility: item.querySelector('.responsibility').value
                });
            });

            // Collect work reference data
            const referenceItems = document.querySelectorAll('.work-reference');
            referenceItems.forEach((item) => {
                formData.workReference.push({
                    position: item.querySelector('.position').value,
                    company: item.querySelector('.company').value,
                    duration: item.querySelector('.duration').value,
                    contactName: item.querySelector('.contact-name').value,
                    contactSurname: item.querySelector('.contact-surname').value,
                    contactEmail: item.querySelector('.contact-email').value,
                    contactPhone: item.querySelector('.contact-phone').value,
                    contactPosition: item.querySelector('.contact-position').value
                });
            });

            // Collect skills data
            const skillInputs = document.querySelectorAll('.skill');
            skillInputs.forEach((input) => {
                formData.skills.push(input.value);
            });

            return formData;
        }

        // Function to send form data to backend
        function sendData(formData) {
            fetch('/generate-cv', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Handle response from backend
                console.log(data);
            })
            .catch(error => {
                // Handle error
                console.error('Error:', error);
            });
        }

        // Event listener for submit button click
        document.getElementById('save').addEventListener('click', function() {
            const formData = collectFormData();
            sendData(formData);
        });
    </script>
</body>
</html>